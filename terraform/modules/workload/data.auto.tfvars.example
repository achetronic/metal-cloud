# Networks definition
# Possible types: nat, macvtap
# nat: Virtual interface with a subnetwork to attach instances
# macvtap: Virtual interface connected directly to a host physical interface, sharing the same network
networks = {

  # Configuration for a NAT
  virnat0 = {
    interface = ""

    # Type of network
    # Possible values: nat, macvtap
    mode = "nat"

    # Assignable IP address blocks in CIDR notation
    # Example: [IPv4/CIDR]
    dhcp_address_blocks = ["10.10.10.0/24"]

    # Address to the gateway
    gateway_address = "10.10.10.1"
  }

  # Configuration for a second NAT
  virnat1 = {
    interface = ""

    # Type of network
    # Possible values: nat, macvtap
    mode = "nat"

    # Assignable IP address blocks in CIDR notation
    # Example: [IPv4/CIDR]
    dhcp_address_blocks = ["10.10.20.0/24"]

    # Address to the gateway
    gateway_address = "10.10.20.1"
  }

  # Configuration for a macvtap
  external0 = {
    # Type of network
    # Possible values: nat, macvtap
    mode = "macvtap"

    # Host physical interface to attach
    # the autogenerated virtual interface
    interface = "eno1"

    # Assignable IP address blocks in CIDR notation
    # Example: [IPv4/CIDR]
    dhcp_address_blocks = ["192.168.0.200/24"]

    # Address to the gateway
    gateway_address = "192.168.0.1"
  }
}

# Instance basic definition.
# WARNING: Choose IP a address inside the right subnet
instances = {

  # Define the LoadBalancer
  kube-loadbalancer-0 = {
    vcpu = 2
    memory = 2048 # 2GB
    disk = 10000000000 # 10GB
    networks = [
      {
        name = "virnat0"
        address = "10.10.10.10/24"
      },{
        name = "external0"
        address = "192.168.0.210/24"
      }
    ]
  }

  # Define the masters
  kube-master-0 = {
    vcpu = 2
    memory = 2048 # 2GB
    disk = 10000000000 # 10GB
    networks = [{
        name = "virnat0"
        address = "10.10.10.20/24"
    }]
  }

  kube-master-1 = {
    vcpu = 2
    memory = 2048 # 2GB
    disk = 10000000000 # 10GB
    networks = [{
        name = "virnat0"
        address = "10.10.10.21/24"
    }]
  }

  # Define the workers
  kube-worker-0 = {
    vcpu = 2
    memory = 2048 # 2GB
    disk = 20000000000 # 20GB
    networks = [{
        name = "virnat0"
        address = "10.10.10.30/24"
    }]
  }
}
